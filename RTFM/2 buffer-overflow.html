<!DOCTYPE html>
<!--[if IE 7]>
<html lang="ru" class="ie7">
<![endif]-->
<!--[if IE 8]>
<html lang="ru" class="ie8">
<![endif]-->
<!--[if (lt IE 7)|(gt IE 8)]><!-->
<html lang="ru">
<!--<![endif]-->
<head>
    <title>Переполнение буфера</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://my.devclub.com.ua/static/dragonscale.css?43">
    <link rel="stylesheet" href="style.css">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>
    <section>
        <h1>Переполнение буфера</h1>
        <div>
            <p>Переполнение буфера <em>(англ. buffer overflow)</em> &mdash; событие, при котором происходит запись данных за пределами выделенного для этой цели буфера (области памяти).</p>
            <p>Переполнение буфера является наиболее широко распространенной уязвимостью программного обеспечения и может привести к перезаписи информации, аварийному завершению программы, или даже к выполнению произвольного кода.</p>
        </div>

        <h2>Пример</h2>
        <div>
            <p><em>Заметка: в зависимости от компилятора и операционной системы, данные могут быть расположены иным образом, нежели показано в примерах этой статьи.</em></p>
            <p>Допустим, что после компиляции две переменные оказались соседями в памяти.</p>
        </div>
        <div>
            <code>char password[8];
int isAdmin = 0;
</code>
        </div>
        <aside>
            <table class="buffer">
                <tr>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>00</td>
                    <td>00</td>
                    <td>00</td>
                    <td>00</td>
                </tr>
            </table>
        </aside>

        <div>
            <code>gets(password);
</code>
            <p>И тут внезапно вводят строку &laquo;hasta la vista&raquo;</p>
            <p>Функция gets понятия не имеет о том, какой размер буфера password, и запишет коды всех полученных символов, начиная с адреса buffer. Соответственно, данные в области памяти, выделенной для переменной isAdmin, также будут перезаписаны. Также будут перезаписаны и данные за областью переменной isAdmin...</p>
        </div>
        <aside>
            <table class="buffer">
                <tr>
                    <td>'h'</td>
                    <td>'a'</td>
                    <td>'s'</td>
                    <td>'t'</td>
                    <td>'a'</td>
                    <td>' '</td>
                    <td>'l'</td>
                    <td>'a'</td>
                    <td>' '</td>
                    <td>'v'</td>
                    <td>'i'</td>
                    <td>'s'</td>
                </tr>
            </table>
            <table class="buffer">
                <tr>
                    <td>68</td>
                    <td>61</td>
                    <td>73</td>
                    <td>74</td>
                    <td>61</td>
                    <td>20</td>
                    <td>6c</td>
                    <td>61</td>
                    <td>20</td>
                    <td>76</td>
                    <td>69</td>
                    <td>73</td>
                </tr>
            </table>
        </aside>

        <h3>Последствия</h3>
        <div>
            <p>Можно догадаться, что четыре последних байта теперь явно не соответствуют числу ноль.</p>
            <p>Как думаете, какое действие теперь произойдет?</p>
            <code>if ( isAdmin ) {
    puts("Launching nuclear missiles...");
} else {
    puts("Access denied!");    
}
</code>
        </div>

        <h2>Предотвращение</h2>
        <div>
            <p>Способ борьбы невероятно прост &mdash; всегда контролировать, куда могут быть записаны данные.</p>
            <p>Например, в приведенном выше фрагменте кода достаточно заменить функцию gets на fgets с указанием лимита считываемых символов.</p>
        </div>
<!-- 
        <h2>Другие последствия</h2>
        <p>При использовании некорректно перезаписанных данных, может произойти аварийное завершение программы.</p>
        <p>Более серьезным последствием является выполнение произвольного кода.</p>
 -->    </section>
</body>
</html>
